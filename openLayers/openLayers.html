<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenLayers | Happy Mr. Wang</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/vuepress-starter/images/wy.jpg">
    <meta name="description" content="My personal blog">
    
    <link rel="preload" href="/vuepress-starter/assets/css/0.styles.9141e0ad.css" as="style"><link rel="preload" href="/vuepress-starter/assets/js/app.291a2017.js" as="script"><link rel="preload" href="/vuepress-starter/assets/js/2.4ae73c30.js" as="script"><link rel="preload" href="/vuepress-starter/assets/js/11.e0b4c16f.js" as="script"><link rel="prefetch" href="/vuepress-starter/assets/js/10.8a7eb7c6.js"><link rel="prefetch" href="/vuepress-starter/assets/js/12.435b99e3.js"><link rel="prefetch" href="/vuepress-starter/assets/js/13.889a8d18.js"><link rel="prefetch" href="/vuepress-starter/assets/js/3.cc49f90b.js"><link rel="prefetch" href="/vuepress-starter/assets/js/4.9f634cb8.js"><link rel="prefetch" href="/vuepress-starter/assets/js/5.602e294e.js"><link rel="prefetch" href="/vuepress-starter/assets/js/6.2f6fa53f.js"><link rel="prefetch" href="/vuepress-starter/assets/js/7.825fc347.js"><link rel="prefetch" href="/vuepress-starter/assets/js/8.8eb3c61f.js"><link rel="prefetch" href="/vuepress-starter/assets/js/9.78d10107.js">
    <link rel="stylesheet" href="/vuepress-starter/assets/css/0.styles.9141e0ad.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-starter/" class="home-link router-link-active"><img src="/vuepress-starter/images/wy.jpg" alt="Happy Mr. Wang" class="logo"> <span class="site-name can-hide">Happy Mr. Wang</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-starter/index/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/vuepress-starter/javaScript/dataStructure/dataStructure.html" class="nav-link">
  数据结构
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vuepress" class="dropdown-title"><span class="title">vuepress</span> <span class="arrow down"></span></button> <button type="button" aria-label="vuepress" class="mobile-dropdown-title"><span class="title">vuepress</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-starter/pressWord/pressBuild/pressBuild.html" class="nav-link">
  vuepress搭建
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-starter/pressWord/pressDeploy/pressDeploy.html" class="nav-link">
  vuepress部署
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-starter/javaScript/knowledge/knowledge.html" class="nav-link">
  js知识点
</a></div><div class="nav-item"><a href="/vuepress-starter/openLayers/openLayers.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  openLayers
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress-starter/index/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/vuepress-starter/javaScript/dataStructure/dataStructure.html" class="nav-link">
  数据结构
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vuepress" class="dropdown-title"><span class="title">vuepress</span> <span class="arrow down"></span></button> <button type="button" aria-label="vuepress" class="mobile-dropdown-title"><span class="title">vuepress</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-starter/pressWord/pressBuild/pressBuild.html" class="nav-link">
  vuepress搭建
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-starter/pressWord/pressDeploy/pressDeploy.html" class="nav-link">
  vuepress部署
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-starter/javaScript/knowledge/knowledge.html" class="nav-link">
  js知识点
</a></div><div class="nav-item"><a href="/vuepress-starter/openLayers/openLayers.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  openLayers
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vuepress-starter/openLayers/openLayers.html" aria-current="page" class="active sidebar-link">OpenLayers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#gis是什么" class="sidebar-link">gis是什么</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#openlayers简介" class="sidebar-link">Openlayers简介</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#openlayers特征" class="sidebar-link">Openlayers特征</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#openlayers的核心概念" class="sidebar-link">Openlayers的核心概念</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#openlayers如何在vue中使用" class="sidebar-link">OpenLayers如何在vue中使用</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#openlayers的主要组成部分" class="sidebar-link">OpenLayers的主要组成部分</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#从ol引入的一些类与方法" class="sidebar-link">从ol引入的一些类与方法</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#一个简单的地图实现" class="sidebar-link">一个简单的地图实现</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#地图事件监听" class="sidebar-link">地图事件监听</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#地图上添加icon" class="sidebar-link">地图上添加icon</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#地图上添加点-线-多边形-圆" class="sidebar-link">地图上添加点，线，多边形，圆</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#给特定区域加上背景颜色" class="sidebar-link">给特定区域加上背景颜色</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#鼠标悬停改变当前区域颜色并且展示当前信息" class="sidebar-link">鼠标悬停改变当前区域颜色并且展示当前信息</a></li><li class="sidebar-sub-header"><a href="/vuepress-starter/openLayers/openLayers.html#地图下钻" class="sidebar-link">地图下钻</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="openlayers"><a href="#openlayers" class="header-anchor">#</a> OpenLayers</h1> <h2 id="gis是什么"><a href="#gis是什么" class="header-anchor">#</a> gis是什么</h2> <p>gis是地理信息系统（geographic information system）简称，是对空间数据进行相关处理的一门学科，一种技术。</p> <h2 id="openlayers简介"><a href="#openlayers简介" class="header-anchor">#</a> Openlayers简介</h2> <p>Openlayers是一个基于Javacript开发，免费、开源的前端地图开发库，使用它，可以很容易的开发出WebGIS系统。目前Openlayers支持地图瓦片、矢量数据等众多地图数据格式，支持比较完整的地图交互操作。目前OpenLayers已经成为一个拥有众多开发者和帮助社区的成熟、流行的框架，在国内外的GIS相关行业中得到了广泛的应用。</p> <h2 id="openlayers特征"><a href="#openlayers特征" class="header-anchor">#</a> Openlayers特征</h2> <p><strong>地图瓦片</strong></p> <p>支持OSM, Bing, MapBox, Stamen等众多的底图数据源</p> <p><strong>矢量数据</strong></p> <p>支持渲染如GeoJSON, TopoJSON, KML, GML, Mapbox vector tiles等等众多的矢量数据</p> <p><strong>高性能、轻量级</strong></p> <p>采用HTML5最新的渲染技术Canvas 2D, WebGL,性能极高。采用Javacript ES6最新的语法，可以实现按需导入，非常的轻量级，非适用于移动GIS开发的场景。</p> <p><strong>易于定制和扩展</strong></p> <p>Openlayers采用面向对象的方法来构建，设计合理，预留了很多可扩充的接口，可以非常容易进行扩展和定制化开发。</p> <p><strong>优秀的交互体验</strong></p> <p>OpenLayers实现了类似于Ajax的无刷新功能，可以结合很多优秀的JavaScript功能插件，带给用户更多丰富的交互体验。</p> <h2 id="openlayers的核心概念"><a href="#openlayers的核心概念" class="header-anchor">#</a> Openlayers的核心概念</h2> <p>Openlayers采用面向对象程序设计（OOP）的思维方法进行设计、开发。把GIS系统中的属性、功能拆分成多个部分，为每一个部分抽象设计出对应的Class(类）。每个Class(类）有自己的属性、自己的行为，通过这些不同的Class(类）相互作用，一起构建了Openlayers的GIS能力。</p> <h2 id="openlayers如何在vue中使用"><a href="#openlayers如何在vue中使用" class="header-anchor">#</a> OpenLayers如何在vue中使用</h2> <ol><li><p>npm install ol</p></li> <li><p>在页面中引入需要用到的类与一些功能方法，底下会做详细介绍</p></li></ol> <h2 id="openlayers的主要组成部分"><a href="#openlayers的主要组成部分" class="header-anchor">#</a> OpenLayers的主要组成部分</h2> <p>地图(Map), 视图(View), 控件(Control), 交互(Interaction)</p> <h2 id="从ol引入的一些类与方法"><a href="#从ol引入的一些类与方法" class="header-anchor">#</a> 从ol引入的一些类与方法</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'ol/ol.css'</span> <span class="token comment">// 样式</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Map<span class="token punctuation">,</span> View<span class="token punctuation">,</span> Feature <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ol'</span> <span class="token comment">// 地图,视图,用于地理特征的矢量元素，具有几何geometry()和其他属性，类似于矢量文件格式(如GeoJSON)中的特性。</span>
<span class="token comment">// import OSM from 'ol/source/OSM' // 可以理解为数据源,就是一张图片</span>
<span class="token keyword">import</span> TileLayer <span class="token keyword">from</span> <span class="token string">'ol/layer/Tile'</span> <span class="token comment">// 可以理解为图层</span>
<span class="token keyword">import</span> <span class="token constant">XYZ</span> <span class="token keyword">from</span> <span class="token string">'ol/source/XYZ'</span> <span class="token comment">// 自定义设置图片链接</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fromLonLat <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ol/proj&quot;</span> <span class="token comment">// 将坐标从经度/纬度转换为不同的投影。</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>toLonLat<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ol/proj'</span> <span class="token comment">// 将坐标转换为经度/纬度。</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> transform <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ol/proj'</span> <span class="token comment">// 将坐标从源投影转换为目标投影。这将返回一个新坐标（并且不会修改原始坐标）。</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Vector <span class="token keyword">as</span> VectorSource <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ol/source'</span> <span class="token comment">// 矢量数据源</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Vector <span class="token keyword">as</span> VectorLayer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ol/layer'</span> <span class="token comment">// 矢量图层</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Point <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ol/geom'</span> <span class="token comment">// 用于添加几何图或者icon,img的位置</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Style<span class="token punctuation">,</span> Icon<span class="token punctuation">,</span> Stroke<span class="token punctuation">,</span> Fill<span class="token punctuation">,</span> Text <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ol/style'</span> <span class="token comment">// 修改矢量样式，icon，文案</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defaults <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ol/control'</span> <span class="token comment">// 设置控件参数</span>
<span class="token keyword">import</span> GeoJSON <span class="token keyword">from</span> <span class="token string">'ol/format/GeoJSON'</span> <span class="token comment">// 数据格式</span>
<span class="token keyword">import</span> anhuiJson <span class="token keyword">from</span> <span class="token string">'@/assets/anhui.json'</span>
<span class="token keyword">import</span> hefeiJson <span class="token keyword">from</span> <span class="token string">'@/assets/hefei.json'</span>
<span class="token keyword">import</span> chuzhouJson <span class="token keyword">from</span> <span class="token string">'@/assets/chuzhou.json'</span>
<span class="token keyword">import</span> Select <span class="token keyword">from</span> <span class="token string">'ol/interaction/Select'</span> <span class="token comment">// 设置鼠标选择类</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> pointerMove <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ol/events/condition'</span> <span class="token comment">// 鼠标移动触发选择</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Overlay <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ol'</span> <span class="token comment">// overlay是覆盖物的意思，主要是放置一些和地图位置相关的元素</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="一个简单的地图实现"><a href="#一个简单的地图实现" class="header-anchor">#</a> 一个简单的地图实现</h2> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>map-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>map<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">height</span><span class="token punctuation">:</span> 100vh</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">olMap</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token comment">// 地图实例</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">initMap</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>olMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'map'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">layers</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token keyword">new</span> <span class="token class-name">TileLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token comment">// source: new OSM({}) // 外网地图图片，访问不了，所以使用底下自定义</span>
            <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">XYZ</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}'</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">view</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">View</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token function">fromLonLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">117.20175263827569</span><span class="token punctuation">,</span> <span class="token number">31.791319694500544</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 地图中心点</span>
          <span class="token comment">// projection: 'EPSG:4326', // 设置坐标系格式</span>
          <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token comment">// 缩放比例</span>
          <span class="token literal-property property">maxZoom</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">// 最大缩放比例</span>
          <span class="token literal-property property">minZoom</span><span class="token operator">:</span> <span class="token number">4</span> <span class="token comment">// 最小缩放比例</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// 设置地图控件</span>
        <span class="token literal-property property">controls</span><span class="token operator">:</span> <span class="token function">defaults</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 不显示放大放小按钮；</span>
          <span class="token literal-property property">rotate</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 不显示指北针控件；</span>
          <span class="token literal-property property">attribution</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// 不显示右下角的地图信息控件</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>效果图
<img src="/vuepress-starter/images/easy-map.png" alt="img"></p> <p>地图容器必须绑定一个id，并且容器必须有高度和宽度，new Map里面的target的值必须与id一样</p> <h2 id="地图事件监听"><a href="#地图事件监听" class="header-anchor">#</a> 地图事件监听</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// singleclick:地图单击事件, dblclick:地图双击事件, click:地图点击事件, pointerdrag：鼠标拖拽事件, pointermove：鼠标移动事件。</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'singleclick'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(transform(this.olMap.getEventCoordinate(e.originalEvent), 'EPSG:3857', 'EPSG:4326')) // 获取点击的坐标并且转换</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">getEventCoordinate</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>originalEvent<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// 获取当前点击的矢量图层</span>
  <span class="token keyword">const</span> fe <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">forEachFeatureAtPixel</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>pixel<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">fe</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fe
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">drillDown</span><span class="token punctuation">(</span>fe<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">getLayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 获取所有图层</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// change:layerGroup :地图图层增删时触发, change:size :地图窗口发生变化就会触发，与我们常用的窗口resize接近</span>
  <span class="token comment">// change:target :地图绑定的div发生更改时触发，如map.setTartget方法就会触发该事件</span>
  <span class="token comment">// change:view :地图view对象发生变化触发。</span>
  <span class="token comment">// propertychange: Map对象中任意的property值改变时触发。</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'change:size'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'size改变'</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// moveend——移动结束事件，首次会加载</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'moveend'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token number">2222222</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="地图上添加icon"><a href="#地图上添加icon" class="header-anchor">#</a> 地图上添加icon</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">setIcon</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> iconImg <span class="token operator">=</span> <span class="token string">'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png'</span> <span class="token comment">// 图片地址</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">13293883.899189748</span><span class="token punctuation">,</span> <span class="token number">3791595.314230861</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">13374601.401058894</span><span class="token punctuation">,</span> <span class="token number">3943246.378348651</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
  <span class="token keyword">const</span> featureList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 打点，设置添加icon的位置</span>
    <span class="token keyword">const</span> feature <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Feature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> index <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment">// 可以无限添加自己想要的参数。</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 加如icon和样式</span>
    feature<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token literal-property property">src</span><span class="token operator">:</span> iconImg<span class="token punctuation">,</span>
        <span class="token comment">// anchor: [0.5, 3], // 偏移位置</span>
        <span class="token comment">// offset: [0, 1], // 偏移量设置</span>
        <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token comment">// 图标缩放比例</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    featureList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 将feature加入数据源</span>
  <span class="token keyword">const</span> vectorSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VectorSource</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">features</span><span class="token operator">:</span> featureList
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 将数据源加入图层</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>vectorLayer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VectorLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">source</span><span class="token operator">:</span> vectorSource<span class="token punctuation">,</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'icon'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 将图层添加到页面</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vectorLayer<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>效果图
<img src="/vuepress-starter/images/map-icon.png" alt="img"></p> <h2 id="地图上添加点-线-多边形-圆"><a href="#地图上添加点-线-多边形-圆" class="header-anchor">#</a> 地图上添加点，线，多边形，圆</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">addFe</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 创建点</span>
  <span class="token keyword">const</span> point <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Feature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">13293883.899189748</span><span class="token punctuation">,</span> <span class="token number">3791595.314230861</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'point'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 创建线</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">13293883.899189748</span><span class="token punctuation">,</span> <span class="token number">3791595.314230861</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">13374601.401058894</span><span class="token punctuation">,</span> <span class="token number">3943246.378348651</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
  <span class="token keyword">const</span> line <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Feature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">LineString</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'line'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 创建多边形</span>
  <span class="token keyword">const</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token punctuation">[</span><span class="token number">13458987.880285729</span><span class="token punctuation">,</span> <span class="token number">3764689.4802744794</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token number">13353810.529365325</span><span class="token punctuation">,</span> <span class="token number">3742675.6161283487</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token number">13521360.495366432</span><span class="token punctuation">,</span> <span class="token number">3666850.0840694536</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token number">13458987.880285729</span><span class="token punctuation">,</span> <span class="token number">3764689.4802744794</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
  <span class="token keyword">const</span> polygon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Feature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Polygon</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'polygon'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> lineStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'rgba(1, 210, 241, 0.2)'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Stroke</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'rgba(255, 0, 0)'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  polygon<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span>lineStyle<span class="token punctuation">)</span>
  <span class="token comment">// 创建圆</span>
  <span class="token keyword">const</span> circle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Feature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">13380716.363321707</span><span class="token punctuation">,</span> <span class="token number">3534766.8991926694</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'circle'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  circle<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">// 填充</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'rgba(255, 255, 255, 0.6)'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Stroke</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">// 边框</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#319FD3'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">20</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> vectorLayer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VectorLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">VectorSource</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">features</span><span class="token operator">:</span> <span class="token punctuation">[</span>point<span class="token punctuation">,</span> line<span class="token punctuation">,</span> polygon<span class="token punctuation">,</span> circle<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>vectorLayer<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><p>效果图
<img src="/vuepress-starter/images/map-fe.png" alt="img"></p> <h2 id="给特定区域加上背景颜色"><a href="#给特定区域加上背景颜色" class="header-anchor">#</a> 给特定区域加上背景颜色</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * @param region 特定区域的Geojson数据
**/</span>
<span class="token function">setBgf</span> <span class="token punctuation">(</span><span class="token parameter">region</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> features <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeoJSON</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">featureProjection</span><span class="token operator">:</span> <span class="token string">'EPSG:3857'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFeatures</span><span class="token punctuation">(</span>region<span class="token punctuation">)</span> <span class="token comment">// 读取Geojson格式数据</span>
  <span class="token keyword">const</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VectorSource</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    features
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token function-variable function">styleFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">featureData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">styles</span><span class="token punctuation">(</span>
      featureData<span class="token punctuation">.</span><span class="token function">getGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 获取几何类型</span>
      <span class="token string">'#31969A'</span><span class="token punctuation">,</span> <span class="token comment">// 颜色</span>
      featureData <span class="token comment">// 当前feature</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> styles <span class="token operator">=</span> <span class="token punctuation">(</span>type<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">'#31969A'</span><span class="token punctuation">,</span> featureData<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> styleType <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">MultiPolygon</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Stroke</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#fff'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> color
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">textAlign</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>     <span class="token comment">//对齐方式</span>
          <span class="token literal-property property">textBaseline</span><span class="token operator">:</span> <span class="token string">'middle'</span><span class="token punctuation">,</span>    <span class="token comment">//文本基线</span>
          <span class="token literal-property property">font</span><span class="token operator">:</span> <span class="token string">'normal 12px 微软雅黑'</span><span class="token punctuation">,</span>     <span class="token comment">//字体样式</span>
          <span class="token literal-property property">text</span><span class="token operator">:</span> featureData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment">//文本内容</span>
          <span class="token literal-property property">offsetY</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// Y轴偏置</span>
          <span class="token literal-property property">offsetX</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// x轴偏移</span>
          <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        <span class="token comment">//填充样式</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#ffffff'</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">Polygon</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Stroke</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#fff'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> color
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">textAlign</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>     <span class="token comment">//对齐方式</span>
          <span class="token literal-property property">textBaseline</span><span class="token operator">:</span> <span class="token string">'middle'</span><span class="token punctuation">,</span>    <span class="token comment">//文本基线</span>
          <span class="token literal-property property">font</span><span class="token operator">:</span> <span class="token string">'normal 12px 微软雅黑'</span><span class="token punctuation">,</span>     <span class="token comment">//字体样式</span>
          <span class="token literal-property property">text</span><span class="token operator">:</span> featureData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment">//文本内容</span>
          <span class="token literal-property property">offsetY</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token comment">// Y轴偏置</span>
          <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        <span class="token comment">//填充样式</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#ffffff'</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> styleType<span class="token punctuation">[</span>type<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> layer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VectorLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'sert'</span><span class="token punctuation">,</span> <span class="token comment">// 赋予图层id，便于鼠标只有悬浮这个id的图层时才会切换效果</span>
    <span class="token literal-property property">source</span><span class="token operator">:</span> source<span class="token punctuation">,</span>
    <span class="token literal-property property">zIndex</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token comment">// opacity: 0.5,</span>
    <span class="token literal-property property">style</span><span class="token operator">:</span> styleFunction
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addHo</span><span class="token punctuation">(</span><span class="token string">'sert'</span><span class="token punctuation">)</span> <span class="token comment">// 添加悬浮样式</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><p>效果图
<img src="/vuepress-starter/images/map-bgf.png" alt="img"></p> <h2 id="鼠标悬停改变当前区域颜色并且展示当前信息"><a href="#鼠标悬停改变当前区域颜色并且展示当前信息" class="header-anchor">#</a> 鼠标悬停改变当前区域颜色并且展示当前信息</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 添加悬浮样式</span>
<span class="token function">addHo</span> <span class="token punctuation">(</span><span class="token parameter">layerId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this.olMap.getLayers 获取map中的所有图层</span>
  <span class="token comment">// map.getLayers().getArray() 获取图层数组</span>
  <span class="token comment">// layer.setVisible(bool) 设置图层是否可见</span>
  <span class="token keyword">let</span> selectPointerMove <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Select</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">condition</span><span class="token operator">:</span> pointerMove<span class="token punctuation">,</span> <span class="token comment">// 触发的方法</span>
    <span class="token literal-property property">layers</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span>layerId<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 设置哪些图层可以被选择，相当于过滤</span>
    <span class="token function-variable function">style</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span> <span class="token comment">// 被选中图层的样式</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// // addInteraction()方法在地图上添加Interaction对象</span>
  <span class="token comment">// // Interaction，是一个虚基类，不负责实例化，交互功能都继承该基类</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">addInteraction</span><span class="token punctuation">(</span>selectPointerMove<span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token function-variable function">styleFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">featureData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">styles</span><span class="token punctuation">(</span>
      featureData<span class="token punctuation">.</span><span class="token function">getGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">'#35DEE4'</span><span class="token punctuation">,</span>
      featureData
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> styles <span class="token operator">=</span> <span class="token punctuation">(</span>type<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">'#35DEE4'</span><span class="token punctuation">,</span> featureData<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> styleType <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">MultiPolygon</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Stroke</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#fff'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> color
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">textAlign</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>     <span class="token comment">//对齐方式</span>
          <span class="token literal-property property">textBaseline</span><span class="token operator">:</span> <span class="token string">'middle'</span><span class="token punctuation">,</span>    <span class="token comment">//文本基线</span>
          <span class="token literal-property property">font</span><span class="token operator">:</span> <span class="token string">'normal 12px 微软雅黑'</span><span class="token punctuation">,</span>     <span class="token comment">//字体样式</span>
          <span class="token literal-property property">text</span><span class="token operator">:</span> featureData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment">//文本内容</span>
          <span class="token literal-property property">offsetY</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// Y轴偏置</span>
          <span class="token literal-property property">offsetX</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// x轴偏移</span>
          <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        <span class="token comment">//填充样式</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#ffffff'</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token comment">// backgroundFill: new Fill({      // 填充背景</span>
          <span class="token comment">//   color: asString([0, 0, 0, 0.6])</span>
          <span class="token comment">// })</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">Polygon</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Stroke</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#fff'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> color
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">textAlign</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>     <span class="token comment">//对齐方式</span>
          <span class="token literal-property property">textBaseline</span><span class="token operator">:</span> <span class="token string">'middle'</span><span class="token punctuation">,</span>    <span class="token comment">//文本基线</span>
          <span class="token literal-property property">font</span><span class="token operator">:</span> <span class="token string">'normal 12px 微软雅黑'</span><span class="token punctuation">,</span>     <span class="token comment">//字体样式</span>
          <span class="token literal-property property">text</span><span class="token operator">:</span> featureData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment">//文本内容</span>
          <span class="token literal-property property">offsetY</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token comment">// Y轴偏置</span>
          <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fill</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        <span class="token comment">//填充样式</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#ffffff'</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token comment">// backgroundFill: new Fill({      // 填充背景</span>
          <span class="token comment">//   color: asString([0, 0, 0, 0.6])</span>
          <span class="token comment">// })</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> styleType<span class="token punctuation">[</span>type<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  selectPointerMove<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'select'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getFeatures</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>array_<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      item<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span><span class="token function">styleFunction</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>selected<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showPop</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>selected<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 删除弹窗</span>
      <span class="token keyword">const</span> card <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">getOverlayById</span><span class="token punctuation">(</span><span class="token string">'pop'</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>card<span class="token punctuation">)</span> card<span class="token punctuation">.</span><span class="token function">setPosition</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 根据id获取对应的图层</span>
<span class="token function">getLayer</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">getLayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>values_<span class="token operator">?.</span>id <span class="token operator">===</span> id<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 根据id删除图层</span>
<span class="token function">removeLayer</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> layer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
  layer <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">removeLayer</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 展示提示弹窗</span>
<span class="token function">showPop</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> fe <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>cityPopList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>allPop<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>id <span class="token operator">==</span> fe<span class="token punctuation">.</span>values_<span class="token punctuation">.</span>adcode<span class="token punctuation">)</span><span class="token operator">?.</span>detail
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cityPopList<span class="token operator">?.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'popup'</span><span class="token punctuation">)</span>
    <span class="token comment">// 创建一个overlay, 绑定html元素container</span>
    <span class="token keyword">const</span> acroutes <span class="token operator">=</span> <span class="token function">fromLonLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span>fe<span class="token punctuation">.</span>values_<span class="token punctuation">.</span>center<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fe<span class="token punctuation">.</span>values_<span class="token punctuation">.</span>center<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> overlay <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Overlay</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'pop'</span><span class="token punctuation">,</span> <span class="token comment">// 为对应的 overlay 设置一个 id，便于使用 ol.Map 的 getOverlayById 方法取得相应的 overlay</span>
      <span class="token literal-property property">element</span><span class="token operator">:</span> container<span class="token punctuation">,</span> <span class="token comment">// domm元素</span>
      <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 偏移量，像素为单位，overlay 相对于放置位置（position）的偏移量，默认值是 [0, 0]</span>
      <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token punctuation">[</span>acroutes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">150000</span><span class="token punctuation">,</span> acroutes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">80000</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 在地图所在的坐标系框架下，overlay 放置的位置</span>
      <span class="token literal-property property">positioning</span><span class="token operator">:</span> <span class="token string">'bottom-center'</span><span class="token punctuation">,</span> <span class="token comment">// overlay 对于 position 的相对位置，可能的值包括 bottom-left、bottom-center、bottom-right 、center-left、center-center、center-right、top-left、top-center、top-right，默认是 top-left，也就是 element 左上角与 position 重合</span>
      <span class="token literal-property property">stopEvent</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 地图的事件传播是否停止，默认是 true，即阻止传播</span>
      <span class="token literal-property property">autoPan</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 当触发 overlay setPosition 方法时触发，当 overlay 超出地图边界时，地图自动移动，以保证 overlay 全部可见</span>
      <span class="token literal-property property">autoPanAnimation</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">250</span>
      <span class="token punctuation">}</span> <span class="token comment">// 设置 autoPan 的效果动画</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    overlay<span class="token punctuation">.</span><span class="token function">setPosition</span><span class="token punctuation">(</span>acroutes<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">addOverlay</span><span class="token punctuation">(</span>overlay<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> card <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">getOverlayById</span><span class="token punctuation">(</span><span class="token string">'pop'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>card<span class="token punctuation">)</span> card<span class="token punctuation">.</span><span class="token function">setPosition</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token comment">// 删除弹窗</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br></div></div><p>效果图
<img src="/vuepress-starter/images/map-se.png" alt="img"></p> <h2 id="地图下钻"><a href="#地图下钻" class="header-anchor">#</a> 地图下钻</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * @param fe 当前点击的feature
**/</span>
<span class="token function">drillDown</span> <span class="token punctuation">(</span><span class="token parameter">fe</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取当前的坐标</span>
  <span class="token keyword">const</span> so <span class="token operator">=</span> <span class="token punctuation">[</span>fe<span class="token punctuation">.</span>values_<span class="token punctuation">.</span>center<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fe<span class="token punctuation">.</span>values_<span class="token punctuation">.</span>center<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
  <span class="token comment">// 删除当前的图层</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeLayer</span><span class="token punctuation">(</span><span class="token string">'sert'</span><span class="token punctuation">)</span>
  <span class="token comment">// 改变当前的缩放级别</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setZoom</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
  <span class="token comment">// 将当前坐标设为中心点</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>olMap<span class="token punctuation">.</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCenter</span><span class="token punctuation">(</span><span class="token function">fromLonLat</span><span class="token punctuation">(</span>so<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">1/4/2023, 9:55:41 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress-starter/assets/js/app.291a2017.js" defer></script><script src="/vuepress-starter/assets/js/2.4ae73c30.js" defer></script><script src="/vuepress-starter/assets/js/11.e0b4c16f.js" defer></script>
  </body>
</html>
